```sql
use mall;

CREATE TABLE `mall_verify_record` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `create_time` bigint(20) NOT NULL,
  `order_goods_id` int(11) NOT NULL,
  `minus_value` int(11) NOT NULL DEFAULT '0' COMMENT '本次核销面额',
  `value` int(11) NOT NULL DEFAULT '0',
  `max_using_times` int(11) NOT NULL DEFAULT '1',
  `surplus_value` int(11) NOT NULL DEFAULT '0',
  `surplus_using_times` int(11) NOT NULL DEFAULT '0',
  `goods_group_id` int(11) NOT NULL COMMENT '发售门店',
  `goods_id` int(11) NOT NULL,
  `order_id` bigint(20) NOT NULL,
  `amount` int(11) NOT NULL,
  `verify_business_id` int(11) NOT NULL COMMENT '核销门店',
  `verify_user_id` int(11) DEFAULT NULL COMMENT '核销人',
  `actual_minus_value` int(11) DEFAULT NULL COMMENT '本次实际核销面额',
  `currency` char(11) NOT NULL DEFAULT '',
  `type` tinyint(11) NOT NULL COMMENT '商品类型',
  `cost` int(11) NOT NULL COMMENT '成本',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


  
    alter table `mall_order_goods` add column   `value` int(11) NOT NULL DEFAULT '0' COMMENT '价值', add column `max_using_times` int(11) NOT NULL DEFAULT '0' COMMENT '最大使用次数', add column `max_using_times` int(11) NOT NULL DEFAULT '0' COMMENT '最大使用次数', add column  `surplus_using_times` int(11) NOT NULL DEFAULT '0' COMMENT '剩余使用次数';

   
 alter table `mall_order` add column  `goods_group_res_type` varchar(45) DEFAULT 'local_event' COMMENT 'goods_group的资源类型';
 
 //加索引
 alter table mall_order drop index i_goods_group_res_type ;
 ALTER TABLE `mall_order` ADD INDEX i_goods_group_res_type ( `goods_group_res_type` ) USING BTREE;

   
  alter table `mall_goods` add column `cost` int(11) DEFAULT '0' COMMENT '成本', add column `value` int(11) NOT NULL DEFAULT '0' COMMENT '价值', add column `max_using_times` int(11) NOT NULL DEFAULT '1' COMMENT '最大使用次数', add column `bright_desc` varchar(100) NOT NULL DEFAULT '0' COMMENT '代金券亮点描述', add column `last_editor` varchar(100) NOT NULL DEFAULT '0' COMMENT '更新人', add column `image_url` varchar(200) NOT NULL DEFAULT '' COMMENT '头图';


   
 alter table `mall_goods_group` add column `lat` decimal(12,8) DEFAULT NULL COMMENT '纬度', add column `lon` decimal(12,8) DEFAULT NULL  COMMENT '经度';
```

```
DROP TABLE IF EXISTS `mall_cart_goods_device`;


CREATE TABLE `mall_cart_goods_device` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `udid` int(10) unsigned NOT NULL COMMENT 'udid',
  `goods_id` int(10) unsigned NOT NULL COMMENT '商品ID',
  `goods_group_id` int(10) unsigned NOT NULL COMMENT '商品组ID',
  `quantity` int(10) unsigned NOT NULL COMMENT '购买数量',
  `price` int(10) unsigned NOT NULL COMMENT '购买单价',
  `discount` int(11) NOT NULL DEFAULT '0' COMMENT '折扣',
  `create_time` bigint(20) NOT NULL,
  `update_time` bigint(20) NOT NULL,
  `state` enum('selected','unselected') DEFAULT 'unselected',
  PRIMARY KEY (`id`),
  UNIQUE KEY `u_key` (`udid`,`goods_id`),
  KEY `i_udid` (`udid`,`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='购物车商品表(未登录的)';
```


```
测试思路

goodsId:537,555
goodsGroupId:254
businessId:194
businessUserId:38


商家PC和主站后台 H5 直接调 微服务接口
APP都走转发
```
```
主站后台:
http://adm.it4.dealmoon.net/pages/index.html#/voucher/store/prereview?_k=k7m5k7

商家后台:
http://biz.it4.dealmoon.net/admin/marketing/900

商家APP:
https://fir.im/h7p2
```

